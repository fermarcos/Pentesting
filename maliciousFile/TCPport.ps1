
    [int]$port=60006
    [string]$IPAdress= (Get-WmiObject -Class Win32_NetworkAdapterConfiguration -Filter 'ipenabled = "true"').IPAddress[0]
    [switch]$Echo=$false
    $listener = new-object System.Net.Sockets.TcpListener([System.Net.IPAddress]::Parse($IPAdress), $port)
    $listener.start()
    [byte[]]$bytes = 0..255|%{0}
    write-host "Waiting for a connection on port $port..."
    $client = $listener.AcceptTcpClient()
    write-host "Connected from $($client.Client.RemoteEndPoint)"
    $stream = $client.GetStream()
    while($true)
    {
        $bytes[0..($i-1)]|%{$_}
        if ($Echo){$stream.Write($bytes,0,$i)}
    }